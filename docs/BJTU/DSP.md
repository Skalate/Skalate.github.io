# 模拟卷

1. 已知有限序列$x[k]=\{\dot{1},2,3,4\}$的频谱为$X(e^{j\Omega})$，若对$X(e^{j\Omega})$在一个周期内进行3点抽样得离散频谱$\tilde{X}[m]$，则$\text{IDFS}\{\tilde{X}[m]\}$在$k=0,1,2$的值为：
   
2. 已知某离散LTI系统的单位脉冲响应为$h[k]=0.6Sa(0.6\pi k) - 0.2Sa(0.1\pi k)$，该系统的幅度响应具有**带通**特性。



3. 已知$x[k]=\{\dot{1},2,3,4\}$，$h[k]=\{\dot{1},1,1\}$，$x[k]$和$h[k]$的6点循环卷积结果是$\{\dot{1},3,6,9,7,4\}$。



4. 利用DFT分析连续时间信号频谱，抽样频率$f_{sam}=1000Hz$，若要求信号频谱中谱线的最小间隔为0.5Hz，则最少的点数为2000。



5. 基2时间抽取FFT算法中由短序列DFT合成长序列DFT的矩阵是。



6. 在设计满足指标的模拟带通滤波器时，需要通过频率映射将模拟带通滤波器设计指标转换为原型模拟低通滤波器设计指标，其中$\omega_p=1$，$\omega_s=$。


7. 以下FIR系统不满足线性相位的是：


8. 对于IIR数字滤波器，系数量化误差的描述哪种是正确的？


9.  已知某线性相位FIR数字滤波器的系统函数为$H(z)=1+2z^{-1}-2z^{-2}-z^{-3}$，其线性相位直接型结构为。



10. 小波变换提供了在时-频域有效描述信号的方法。

小波变换提供了同时在时域和频域进行局部分析。






## 二、（12分）DFT分析信号频谱

（1）已知某音频信号$x(t)$的最高频率为$f_m=3.4 kHz$,现用抽样频率$f_{sam}=8kHz$对$x(t)$进行抽样，对抽样获得的离散序列做1600点DFT。试确定连续信号频谱中的频率点$f=3kHz$以及$f= -2kHz$对应DFT的结果$X[m]$中的哪两个点。

解：

对连续信号$x(t)$按$f_{sam}=8kHz$进行抽样，得到对应的离散序列，再利用离散序列 DFT 分析连续信号$x(t)$的频谱时，$X[m]$与$X(j\omega)$存在以下对应关系：

当$0 \leq m \leq N/2-1$，$X[m]$对应于$X(j\omega)$在频率点的抽样值
$$\omega = \dfrac{\omega_{sam}}{N}m$$
当$N/2 \leq m \leq N-1$，$X[m]$对应于$X(j\omega)$在频率点的抽样值
$$\omega = \dfrac{\omega_{sam}}{N}m - \omega_{sam} = \dfrac{\omega_{sam}}{N}(m-N)$$

$$3kHz \to 600, -2kHz \to 1200$$

（2）给出利用DFT近似计算连续非周期无限长信号频谱的主要步骤。在此过程中会产生哪些误差，如何改善?

解：

由此可见，在连续信号$x(t)$为带限信号，且为时限信号时，可由$x(t)$时域抽样得到其有限长的序列$x[k]$, 通过$x[k]$的DFT可准确地得到$X(j\omega)$的样点值（只相差一个常数T），从而实现连续信号$x(t)$的频谱分析。

但在实际工程信号中，连续信号$x(t)$不可能既为带限信号又为时限信号，因此存在由于非带限而引起的混叠现象，以及由于非时限而引起的泄漏现象。

因此，在利用DFT分析连续时间信号$x(t)$的频谱时，由于$x(t)$难以同时满足带限信号和时限信号的条件，因而必然存在误差，只能实现连续时间信号$x(t)$频谱的近似分析



## 三、（8分）DFT分析信号频谱

$x[k]$和$y[k]$均为N点的实序列。$x[k]$的DFT为$X[m]$，$y[k]$的DFT为$Y[m]$。现在已知$X[m]$和$Y[m]$，试给出从$X[m]$和$Y[m]$求取$x[k]$和$y[k]$的方案，而且为了提高运算效率，要求只采用一次N点FFT，并写出主要公式。

解：

是


## 四、（10分）IIR数字滤波器设计

(1)简述IIR数字滤波设计器的基本思想;

解：

在设计IIR数字滤波器时，一般通过模拟滤波器来设计数字滤波器的。设计方法是先将数字滤波器技术指标转换为对应的模拟滤波器技术指标，然后设计满足技术指标的模拟滤波器，再将模拟滤波器$H(s)$转换为对应的数字滤波器 $H(z)$，因此，在IIR滤波器设计中，模拟滤波器设计是基础，模拟滤波器转换为数 滤波器是核心，而模拟滤波器的设计都是通过设计模拟低通滤波器而实现，比较常用的模拟低通滤波器有 Butterworth (巴特沃思）和 cheby( 切比雪夫）等 将模拟滤波器转换为数字滤波器 主要方法有脉冲响应不 变法和双线性变换法



(2)给出IIR数字带阻滤波器设计的主要步骤及关键公式;（例4-4）

解：

1. 通过频率转换将模拟带阻滤波器的技术指标 r, ,w"2 ,w., ,w,2 ,A P ,A, 转换为原型低通滤波器技术指标$\omega_p, \omega_s, A_p, A_s$。
2. 将模拟滤波器的设计指标转换为模拟低通滤波器的设计指标，通过 BW 型、 CB 型或椭圆模拟低通滤波器设计原型低通滤波器$H_L(s)$
3. 通过复频率转换将原型低通滤波器的系统函数$H_L(s)$转换为模拟带阻滤波
器系统函数$H_{BS}(s)$
4. 利用双线性变换将模拟带阻滤波器$H(s)$转换为数字带阻滤波器$H(z)$，即$H(z)=H(s)|_{s=\dfrac{2}{T}\dfrac{1-z^{-1}}{1+z^{-1}}}$

(3)利用BW型模拟低通滤波器和脉冲响应不变法设计满足指标$W_p=0.2p rad$，$W_s=0.6p rad$，$A_p \le 2dB$，$A_s \ge 15dB$的数字低通滤波器。设计出来的滤波器幅度响应如图1所示：
经测试，通带衰减为，阻带衰减为，阻带衰减不满足设计要求，请给出原因以及解决办法。（例4-5）

解：

原因：BW 型模拟低通滤波器不是带限的，脉冲响应不变法所设计的数字滤波
器存在频谱混叠。

解决方法：提高滤波器阶数，或者使用双线性变换法。

由上面的分析可知，在利用脉冲响应不变法将模拟滤波器转换为数字滤波器时，由于模拟频率$\omega$与数字频率$\Omega$之间呈线性关系，即$\Omega=T\omega$, 所以在模拟滤波器的频率响应是带限的情况下，数字滤波器能较好地保持模拟滤波器的幅度响应 但由于实际应用中模拟滤波器一般都不满足带限条件，由式 (4-51) 可知，数字滤波器的频率响应都存在一定程度的混叠。对于模拟低通和带通滤波器，可通过减小抽样间隔T或增大模拟滤波器在阻带的衰减，使混叠引起的误差处于可接受的范围内，对于模拟高通和带阻滤波器，由于存在严重的混叠，所以不能用脉冲响应不变法将模拟高通和带阻滤波器转换为数字滤波器。


## 五、（15分）试用窗函数法设计一个线性相位FIR数字滤波器。使其幅度响应逼近一个截频为0.4πrad的理想低通滤波器。要求阻带衰减大于30dB.

(1)给出窗函数法设计线性相位FIR滤波器的主要步骤及关键公式。

解：

窗函数法设计 FIR 滤波器的基本思想 在时域逼近理想滤波器的单位脉冲响应。首先根据待逼近的理想滤波器的频率响应凡(e IDTFT 求出理想滤波器的单位脉冲响应 hJk], 再将无限长的凡[ k] 加窗截短得到有限长序列 h[k] 为了获得因果线性相位 FJR 滤波器，在窗函数法设计 FfR 滤波器的过程中，需要将线性相位因子$e$加入理想滤波器的频率响应$H(e^{j\Omega})$，具体步骤如下：
1. 根据待逼近的理想滤波器的频率响应 H,1 (ejn)' 确定线性相位 FIR 滤波器的类型(I型、II型、Ⅲ型、Ⅳ型）
2. 根据理想滤波器的频率响应及幅值响应的对称特性，确定理想滤波器幅值响应的表达式。
3. 确定理想滤波器的相位，对Ⅰ型和Ⅱ型线性相位FIR滤波器，$\beta=0$，对Ⅲ型和Ⅳ型线性相位FIR滤波器，$\beta=\pi/2$。
4. 通过IDTFT计算，$h_d[k]=\dfrac{1}{2\pi}\int_{<2\pi>}{A_d(\Omega)e^{j\phi_d(\Omega)}e^{j\Omega k}d\Omega}$
5. 通过加窗截短$h_d[k]$得$h[k]=h_d[k]w[k]$，其中$w[k]$是长度N=M+1的窗函数。（例5-1）

(2)若要求滤波器的阶数M=6线性相位FIR滤波器，试求出$h[k]$的表达式:

解：例5-4

M=6 的线性相位 FIR 滤波器的$h[k] = \dfrac{\Omega_c}{\pi}Sa(\Omega_c(k-0.5*6))=0.4Sa(0.4\pi(k-3))$


(3)简述不同窗函数类型对阻带衰减的影响。

解：

矩形窗：阻带衰减达不到要求，需要换非矩形窗进行截断。

由表可知，矩形窗的过渡带最窄，但利用它设计出的 FIR 滤波器的阻带衰减最小 利用 blackman 窗设计出的 IIR 滤波器阻带衰减最大，但其过渡带也最宽 显然，减小了窗函数旁瓣的相对幅度却增加了其主瓣的宽度，即提高 FIR 滤波器阻带衰减是以增加过渡带宽度为代价的 在工程应用中，在满足阻带衰减的前提下，尽可能地选择主瓣宽度较小的窗函数



## 六、（10分）已知连续信号的频谱如图所示。底为$2400\pi$的三角波信号。


（1）试画出抽样频率为4kHz时，对$x(t)$抽样所得离散序列$w[k]$的频谱。

解：


（2）试画出抽样频率为5kHz时，对$x(t)$抽样所得离散序列$y[k]$的频谱。

解：


（3）试画出数字抽样频率变换系统的框图，使其输入为$y[k]$，输出为$w[k]$。给出系统中数字滤波器的通带频率和阻带频率，画出框图中各输出序列的频谱。

解：





## 七、（10分）

（1）为什么要引入短时傅里叶变换？短时傅里叶变换有何缺点？

解：

傅里叶变换只有信号的频率信息而没有时间信息，因此引入短时傅里叶变换。(3 分)

短时傅里叶变换的缺点：短时傅里叶变换的实质是加窗了的傅里叶变换，其窗固定，无法同时获得较高的时间分辨和频率分辨。


（2）Haar小波函数$\psi_H(t)$与Haar尺度函数$\varphi_H(t)$如图所示，试给出图所示信号$x(t)$关于$\psi_H(t)$和$\varphi_H(t)$的表达式。

解：

$$x(t) = \phi_H(t)+\phi_H(t-1)+\phi_H(t-2)+\Phi_H(t-1)$$



## 八、（5分）试写出你在研学过程中调用过的5个MATLAB函数并说明每个函数的功能（显示函数除外）。

解：

- conv 卷积
- xcorr 相关
- filter 求解 LTI 系统响应
- freqz 分析离散系统频率响应
- fft 离散傅里叶变换
- ifft 离散傅里叶反变换
- fftshift 将 FFT 的 DC 分量移到频谱中心即对频域的图像（重排序）
- abs 幅度谱
- angle 相位谱
- mod 模运算
- buttord 确定 BW 型模拟低通滤波器阶数和 3dB 截频
- butter 确定 BW 模拟低通滤波器的分子和分母多项式系数
- impinvar 脉冲响应不变法
- bilinear 双线性变换法
- firl 窗函数法设计 FIR 滤波器
- wavread 读音频文



