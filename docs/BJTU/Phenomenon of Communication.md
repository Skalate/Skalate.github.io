

以电信号为物理载体的通信系统：信源  发送设备（调制）  信道  接收设备（解调）  信宿  
信源：分为模拟信源（传感器输出的信号，基带电信号）、数字信源（存储的信号，比特）  
基带信道：建模为低通滤波器  
频带信道：建模为带通滤波器  
模拟基带传输、模拟频带传输、数字基带传输、数字频带传输  
确定信号分析、随机信号分析 


**先修课**  
> 《高等数学》《线性代数》《概率论》《信号与系统》 


**学习视频**
> 杨鸿文  北京邮电大学  《通信原理》  
> 郭宇春  北京交通大学  《通信原理》


**参考书籍**  
> 周炯磐《通信原理》第4版  
> 曹志刚《通信原理与应用》  
> 主旨：通信的一般性原理，即通信问题的数学原理。


# 基础

## 高等数学
余弦函数：$x(t) = A\cos(\omega t + \theta)$  
三角公式：$\cos(\alpha+\beta) = \cos(\alpha)\cos(\beta) - \sin(\alpha)\sin(\beta)$  
Euler公式：$e^{jx} = \cos(x) + j\sin(x)$  



## 线性代数
内积
$$<x,y> = \int^{+\infty} _{-\infty}{x(t)y^*(t)dt}$$

正交
内积为零称为正交



确定信号：未来某个时刻t上信号取值确定  
随机信号：未来某个时刻t上信号取值不确定



## 概率统计


### Gaussian Distribution
高斯分布（Gaussian Distribution）也称正态分布（Normal Distribution）。
$$X \sim N(\mu, \sigma^2),p_X(x)=\frac{1}{\sqrt{2\pi \sigma^2}}e^{-\frac{(x-\mu)^2}{2\sigma^2}}$$

**概率积分函数**
$$\Phi(x) = \int_{-\infty} ^x {\frac{1}{\sqrt{2\pi}\sigma_X}e^{-\frac{z^2}{2}}dz}$$  

**标准化（归一化）正态分布**
$$X \sim N(0,1), p_X(x)=\frac{1}{\sqrt{2\pi}}e^{-\frac{x^2}{2}}$$

**中心极限定理**

**Q函数**
$$Q(x)\sim N(0,1),Q(x) = 1 - \Phi(x) = Pr\{ X>x \} = \int ^\infty _x {\frac{1}{\sqrt{2\pi}\sigma_X}e^{-\frac{z^2}{2}}dz}$$  

**误差函数**
$$erf(x)=\frac{2}{\sqrt{\pi}}\int ^x _{-\infty} {e^{-t^2}dt}$$

**互补误差函数**
$$erfc(x)\sim N(0,0.5),erfc(x) = 2Q(\sqrt{2}x) = Pr\{ |X|>x \}=\frac{2}{\sqrt{\pi}}\int ^\infty _x {e^{-t^2}dt}$$

### 概率分布
联合分布（Joint Distribution）

边沿分布（Marginal Distribution）



### 数字特征
**互相关**
$$R_{XY} = E[XY] = \int_{-\infty}^\infty {\int_{-\infty}^\infty {xyp(x,y)dxdy}}$$

**协方差**
$$C_{XY} = Cov(X,Y) = E[(X-m_X)(Y-m_Y)] = R_{XY} - m_Xm_Y$$

**互相关系数**
$$\rho_{XY} = \frac{Cov(X,Y)}{\sigma_X\sigma_Y}, -1<\rho_{XY}<1$$

统计独立

不相关


## 信号基础

### 常见信号

**信号分类**
> 周期信号VS非周期信号  
> 基带信号 vs 频带信号  
> 能量信号 vs 功率信号  
> 模拟信号 vs 数字信号  
> 确知信号 vs 随机信号  

**正弦波（sinusoid）**：$s(t) = A \cdot cos(2\pi f_0 t + \theta)$  
正弦波也可称为单频信号、单音信号。在不需要谈论相对关系时，sin和cos都属于正弦波。若A, θ中至少有一个随t变化，则称为受调制的正弦波
  
**矩形脉冲**：$rect(\frac{t}{T})$  
矩形脉冲的持续时间有限；

**sinc脉冲**：$sinc(\frac{t}{T}) = Sa(\frac{\pi t}{T}) = \frac{sin(\frac{\pi t}{T})}{\frac{\pi t}{T}}$  
sinc脉冲的持续时间无限，有周期性零点

**直流信号**：直流是无限宽的矩形或sinc  

**Dirac冲激信号**：$\delta(t)$  
狄拉克（Dirac）冲激是面积为1、无限窄的矩形或sinc




### 功率与能量
能量＝功率×时间，功率＝能量÷时间  
$$P(t) = S^2(t), E = \int ^\infty _{-\infty} {S^2(t)dt}, P = $$

如果能量有限，则称为能量信号。如果能量无限，但功率有限，则称为功率信号  

**常见信号的能量或功率**  
直流信号$s(t) = A, P = A^2$  
正弦信号$s(t) = A \cdot cos(2\pi f_0 t + \theta), P = \frac{A^2}{2}$  
矩形脉冲$s(t) = A \cdot rect(\frac{t}{T}), E = A^2T$

**能量及功率的性质**  
非负性、平方比例性、时移不变性、不满足叠加性  
1. 能量、功率非负；
2. 信号乘以系数K，能量或功率将乘以$K^2$；
3. 时延不改变能量或功率；
4. 能量或功率一般不满足叠加性  

**能量谱密度**  
能量信号$x(t)$的能量谱密度$E_x(f)$是其总能量$E_x$在频率轴$-\infty<f<\infty$上分布密度，总能量是能量密度的积分。  
互能量谱密度是其互能量在频率轴$-\infty<f<\infty$上分布密度  



**内积：自能量与互能量**
$$<x,y> = \int^{+\infty} _{-\infty}{x(t)y^*(t)dt}$$
信号与自己内积是自能量，信号之间的内积是互能量  
互能量：$E_{xy} = \int^{+\infty} _{-\infty}{x(t)y^*(t)dt}$  
自能量：$E_x = \int^{+\infty} _{-\infty}{|x(t)|^2dt}$  



### 复信号
复信号是一对实信号，复信号的能量或功率定义为这一对实信号各自的能量或功率之和。  
复数：$z = a + j\cdot b = Ae^{j\varphi}$  
复信号：$z(t) = a(t) + j\cdot b(t) = A(t)e^{j\varphi(t)}$  
复信号的瞬时功率$P_Z(t) = |z(t)|^2$是实部和虚部瞬时功率之和；  
复信号$z(t)$的平均功率$P_Z$是$|z(t)|^2$的时间平均；  
复信号$z(t)$的能量是$|z(t)|^2$的积分：

复信号也可以分成能量信号和功率信号，特点：非负、系数的模平方、时延不改变能量或功率、一般不满足叠加性  



### Fourier变换
信号$x(t)$的傅里叶变换是$x(t)$与复信号$e^{j2\pi ft}$的内积：
$$X(f) = F[x(t)] = \int^{+\infty} _{-\infty}{x(t)[e^{j2\pi ft}]^*dt} = \int^{+\infty} _{-\infty}{x(t)e^{-j2\pi ft}dt}$$

$X(f)$为$x(t)$的频谱密度或频谱。有时也会用$X(j\omega)$表示  
傅里叶反变换$x(t) = F^{-1}[X(f)] = \int^{+\infty} _{-\infty}{X(f)e^{j2\pi ft}df}$

**初值定理**：一个域（时域）中的原点值是另一个域（频域）中的面积
$$x(t) = \int^{+\infty} _{-\infty}{X(f)e^{j2\pi ft}df}, X(f) = \int^{+\infty} _{-\infty}{x(t)e^{j2\pi ft}dt}$$

> 矩形信号的Fourier变换是sinc，sinc信号的Fourier变换是矩形信号。  
> 时域越宽，频域越窄；频域越宽，时域越窄  
> 直流的Fourier变换是冲激，冲激的Fourier变换是矩形  
> 时域镜像，则频域镜像  
> 时域共轭，则频域镜像共轭

傅氏变换与反变换的定义涉及广义积分。如果积分不存在，则相应的傅氏变换或反变换也不存在。如果某个信号的傅氏变换或反变换不存在，那么从数学上来说，基于此所做出的进一步推导分析都是不成立的。


### 信号数理
**内积**  
时域内积=频域内积。
信号的能量是信号与其自身的内积，信号与自身的内积是能量，不同信号之间的内积为互能量  
对于实信号，信号交换次序不改变互能量：$E_{xy} = E_{yx}$  
对于复信号，交换信号次序后，互能量变成共轭关系：$E_{xy} = E_{yx}^*$  
两个信号叠加后总能量可能因为互补而更强，也可能因为相互抵消而减弱。互能量反映的就是这种相互作用。

**正交**  
内积为零称为正交。由于时域内积等于频域内积，所以如果两个信号在时域正交，它们在频域也正交。

**帕瑟瓦尔（Parseval）定理**  
根据时域内积=频域内积得到，因此能量可以在时域计算，也可以在频域计算。结果不变。

**柯西-许瓦兹不等式**  
互能量的模值小于等于自能量的几何平均：$|E_{xy}| \le \sqrt{E_x E_y}|$，等号在$x(t)=Ky(t)$时成立  

证明：$z(t)=y(t)-\frac{E_{yx}}{E_x}x(t)$，可以看出$z(t)$与$x(t)$正交，即$z(t)$与$x(t)$的互能量$E_{zx}$为0。$y(t)=z(t)+\frac{E_{yx}}{E_x}x(t)$。

**相关函数**  
两个能量信号的相关函数是它们时间错开之后的内积。不同信号之间相关函数叫互相关函数，同一信号的相关函数叫自相关函数。
自相关函数：$R_{x}(\tau) = \int ^\infty _{-\infty} {x(t+\tau)x^*(t)dt}$  
互相关函数：$R_{xy}(\tau) = \int ^\infty _{-\infty} {x(t+\tau)y^*(t)dt}$  
实信号的自相关函数：$R_{x}(\tau) = \int ^\infty _{-\infty} {x(t+\tau)x(t)dt}$  
实信号的互相关函数：$R_{xy}(\tau) = \int ^\infty _{-\infty} {x(t+\tau)y(t)dt}$  
注意：定义可以有多种写法，如$t+\tau$写成$t-\tau$等，只要前后保持自洽即可。  

互相关函数的共轭对称性：调换次序后，相关函数共轭镜像，自相关函数共轭偶对称  
$$R_{xy}(\tau) = R_{yx}^*(-\tau)$$

实信号的互相关函数：$R_{xy}(\tau) = R_{yx}(-\tau)$实信号的自相关函数是偶函数  

$x(t)$的能量是自相关函数在$\tau = 0$处的值：
$x(t)$和$y(t)$的互能量是互相关函数在$\tau = 0$处的值：

根据许瓦兹不等式，内积的模值不超过自能量的几何平均$|R_{xy}(\tau)| = \sqrt{E_x \cdot E_y}$
自相关函数在$\tau = 0$时最大，最高点的值是能量



### 信号的带宽
在物理层通信中，带宽这个词的含义是信号在频域的宽度。  
凡信号都有频谱（傅氏变换、能量谱密度或功率谱密度），频谱是频率f的函数。带宽说的是这个函数图像在f轴上的宽度。  
重要：在实践中，实信号的带宽只按正频率部分计算。

实信号的能量或功率谱密度是f的偶函数。为了照顾工程上不区分正负频率的习惯，有了单边谱密度的概念。它是将原来的能量谱密度或功率谱密度（称为双边谱）中$-\infty<f<\infty$的部分对折到$0<f<\infty$

基带信号（低通信号）：信号的功率或能量主要集中在$f=0$附近  
频带信号（带通信号）：信号的功率或能量主要集中在某个载频$f_c$附近

**带宽分类**  
绝对带宽：频谱在某个区间之外为零，该区间的宽度就是绝对带宽。  
主瓣带宽：有些信号的频谱呈现出主瓣、旁瓣的特征，其带宽可采用主瓣的宽度来衡量  
3dB带宽：能量或功率谱密度从峰值下降一半（3dB）的宽度。注意在本课中，dB永远是对能量或功率而言的。如果按傅氏变换或传递函数算3dB带宽时，一定要将它平方以变成能量谱密度，然后再看下降一半的位置在哪里  
等效矩形带宽：能量或功率谱密度同高同面积的矩形的宽度  
按能量占比定义的带宽：在某个频带范围内集中了一定比例的能量或功率。例如：按82.5%算的带宽为120Hz  
信号平方的带宽：设实基带信号$x(t)$的绝对带宽是W，那么$x^2(t)$的绝对带宽是2W。  
正弦调制的带宽：设实基带信号$x(t)$的绝对带宽是W，那么正弦调制后的已调信号$s(t) = x(t)cos(2\pi f_c t),f_c>W$的绝对带宽是2W。  



### 线性时不变（LTI）系统
零状态响应：没有输入就没有输出  
线性：和的输出是各自输出之和  
时不变：输入推迟则输出也推迟  
输入输出关系：时域卷积、频域乘积  



### 采样
Nyquist采样定理



### 量化
从数学上说，第 7 章所讲的量化与第 6 章讲的判决域是一回事。一般意义下的𝑏比特量化是把 N 维空间分割成𝑀 = 2௕个区域。这种情况叫矢量量化。我们考虑最简单的情况：一维量化或者叫标量量化，它与 MASK 有相似之处。  

标量量化最常见的是均匀量化，AD 变换器就是均匀量化。  
量化一定有损失。量化比特数越多，量化越精细，其损失也越小。  
量化输出可以看作是量化输入（有用信号）叠加了量化误差（噪声），因此量化的损失可以用量化信噪比描述。定义为量化器输入功率与量化噪声功率之比。  
量化器的设计不同，量化信噪比也不同。给定量化比特数的情况下，能使量化信噪比最大的设计叫最优量化。最优量化与输入的统计特性有关，如果输入均匀分布，最优量化就是均匀量化，其信噪比是量化级数的平方。  

将实数序列$\{{x_n\}}$变换成比特序列$\{{b_n\}}$的整体过程（即图中的数字化）叫做量化编码。
量化分标量量化、矢量量化。标量量化是将$\{{x_n\}}$中的元素逐一处理，矢量量化则是按组处理。以下所说的量化一律指标量量化。

量化是将每个$x_n$的可能取值范围分割成个$M=2^b$个区间。  
编码是对这些区间做二进制整数编号，从而使$x_n$变成了b个比特。若采样率是$f_S$，则量化编码后的比特速率是$bf_S$。  

量化函数（量化器。）：从发送端的输入，到接收端的输出，整体构成了一个函数映射。称此映射为量化函数
注：“量化器”可以单指发送端的量化功能，也可以指本页所说的从发到收的整体映射。

每个区间对应一个输出，所以量化函数是一个阶梯函数。

量化边界  量化级数$M=2^b$  量化比特数$b = \log_2M$  量化区间$(x_{k-1}, x_k)$  量化间隔$\triangle_k = x_k - x_{k-1}$

量化误差定义为量化器输出与输入之差：$e_q = y - x$  
可将量化输出理解为：量化输出叠加了量化误差。也称
为量化噪声$e_q$  
量化信噪比：$\frac{S}{N_q} = \frac{E[x^2]}{E[e_q^2]}$

量化输入功率：
量化输出功率：
量化噪声功率：



### A律十三折线编码
A律十三折线编码是一种经典的语音编码。其精华思想是：
(1)采用对数量化来应对话音信号的高动态范围问题。
(2)通过折线来近似A律压缩特性——这在模拟电路的年代是很重要的，否则就很难实现了。

标准PCM语音编码
电话信号数字化的一个国际标准
电话信号频带：300~3400Hz
采样率：8kHz
每个样值按A律十三折线编码规则编为8比特
最终速率64kbit/s

A律十三折线编码属于对数量化
对数量化常用于解决输入信号的动态范围（峰均比）过大的问题
对数量化是非均匀量化：小信号量化更细，大信号量化相对较粗


**A律十三折线编码规则**
每个样值编为8比特
极性码、段落码、段内码




# 通信原理

## 通信系统概述


### Hilbert Transform & Analytic Signal
希尔伯特变换（Hilbert Transform）：实信号通过一个特定滤波器的输出；  
解析信号（Analytic Signal）：虚部是实部的希尔伯特变换，只有正频率分量  

**Hilbert滤波器**  
$$x(t) \stackrel{Hilbert}{\longrightarrow} \tilde{x}(t)$$  
时域冲激响应：$h(t)=\frac{1}{\pi t}$  
频域传递函数：$H(f)=-j \cdot sgn(f)=\begin{cases} -j & f>0\\j & f<0\end{cases}$  
性质1：偶函数的希尔伯特变换是奇函数，奇函数的希尔伯特变换是偶函数  
性质2：$x(t)$与$\tilde{x}(t)$正交，即$\int^{+\infty} _{-\infty}{x(t)\tilde{x}(t)dt}=0$，可利用时域内积等于频域内积来证。  
能量谱密度：$E_{\tilde{x}(t)}(f)=|-jsgn(f)X(f)|^2=|X(f)|^2=E_x(f)$  
能量谱密度对应到时域是自相关函数：$R_{\tilde{x}}(\tau)=R_x(\tau)$  
希尔伯特变换不改变能量谱密度、不改变自相关函数。

互能量谱密度  
以上关系对功率信号类似。总之，由于希尔伯特变换的传递函数满足$|H(f)|^2=1$。因此希尔伯特变换不改变能量（功率）谱密度，不改变自相关函数。当然也不改变功率或能量，因为$R_{\tilde{x}}(\tau)=R_x(\tau)$，而能量或功率是自相关函数在$\tau = 0$处的值。  


**解析信号**  
实信号$x(t)$的解析信号$z(t) = x(t) + j \cdot \tilde{x}(t)$  
$z(t)$相当于是$x(t)$通过了一个特定滤波器之后的输出。  
这个滤波器的传递函数为：$H(f) = 1 + j \cdot [-j \cdot sgn(f)] = 1 + sgn(f) = \begin{cases} 2, & f>0 \\ 0, & f<0 \end{cases}$  
解析信号的频谱为：$Z(f) = H(f) X(f) = \begin{cases} 2X(f), & f>0 \\ 0, & f<0 \end{cases}$  
解析信号的功率谱密度是原功率谱密度乘以传递函数的模平方：$P_z(f) = |1+sgn(f)|^2 P_x(f) = \begin{cases} 4P_x(f), & f>0 \\ 0, & f<0 \end{cases}$  



### complex envelope
无论是手机，还是卫星，发送的信号都是带通信号。本讲要讲的是：有一种方法，它能把带通信号等效成低通信号，这个等效的基带信号叫做复包络（complex envelope）。  

复包络这个概念并不复杂：  
1. 带通信号的频谱是左右对称的，因此已知正频率部分即可。也就是说已知解析信号即可。  
2. 将这个正频率部分随意进行频率搬移不损失信息，那么我们不妨把fc搬到原点，这样就得到了一个基带型的信号，它就是复包络。  

带通信号是指频谱集中在某个载频$f_c$附近的信号。注意$f_c$不一定必须是信号频带的中心频率。本课中提到的带通信号一般指手机等无线通信设备发射的信号，因此带通信号默认是实信号，载频$f_c$充分大。。一般来说，手机等无线通信的信号带宽远小于载波频率𝑓c。这样的信号也可称为窄带信号。出于本讲后续推导的需要，我们假设最高频率不会超过$2f_c$。也就是假设带通信号的正频率部分处在$(0,2f_c)$范围内。  
将解析信号$z(t)$的频谱$Z(f)$搬移至基带（把$f_c$搬移到原点），所得到的频谱$X_L(f)$对应一个基带信号$x_L(t)$，称$x_L(t)$为$x(t)$的复包络（complex envelope）  



## 随机过程

### 随机过程
确定实验的结果有可重复性：重的复实验必有重复的结果  
随机实验的结果不具有可重复性：重复实验的结果未必重复  
随机实验是从样本空间中随机抽取  
对于随机实验，实验之前（抽取之前）结果具有多种可能性；实验之后（已从样本空间中抽取了一个结果），结果是确定的。  

随机变量：随机实验的样本空间是实数集合，随机变量𝑋𝑋表示从许多实数{𝑥1, 𝑥2, ⋯ }中随机抽一个  
随机过程：本课中的随机过程也叫随机信号，其随机实验的样本空间是函数的集合。随机过程𝑋(𝑡)表示从许多实函数{𝑥1(𝑡), 𝑥2(𝑡), ⋯ } 中随机抽一个。  
在随机过程的随机实验中，若对实验结果只取某个特定时刻的函数值，则该实验的结果是随机实数。因此，也可以将随机过程理解为：在每个时刻𝑡𝑡都随机抽了一个实数，即随机过程𝑋(𝑡)是沿时间轴排列的无数个随机变量。  

随机过程的均值：随机过程是沿时间排列的无数个随机变量，对其中的每个随机变量可以谈论其数学期望（也叫统计平均、均值、期望）。这些随机变量的均值未必相同，所以随机过程的数学期望一般来说是时间的函数：$E[X(t)]=m_X(t)$  
对于任意随机过程$X(t)$，令$\tilde{X}(t)=X(t)-m_X(t)$，则$\tilde{X}(t)$是一个新的随机过程，其数学期望是$E[\tilde{X}(t)]=0$。这说明任意随机过程可以看成是零均值过程与确定函数的和：$X(t)=\tilde{X}(t)+m_X(t)$。基于这一点，在有些研究中我们只考虑零均值的随机过程。  


**统计平均**  
时间平均是函数的平均高度；

**时间平均**  
统计平均是随机的事物按随机抽取中的出现机会加权平均。  



### 平稳过程
随机信号分两种，一种是平稳的，一种是非平稳的。简单来说，“平稳”的意思（特点）就是：随机信号的统计特性与绝对时间t无关。如果此处说的“统计特性”指随机信号的均值及自相关函数，则称为平稳过程。平稳过程又分严平稳过程和宽平稳过程（广义平稳过程，常见）。本课中所涉及的噪声一般可建模为**广义平稳过程**。  

通俗解释：甲从库中大量抽取并做统计分析。然后乙偷偷地将库中所有函数的原点进行了统一的平移。甲又对这个被乙动过的库进行大量抽取和统计分析。如果甲不可能通过统计数据发现乙修改了函数的原点位置，就是平稳过程。甲不可能只通过观察$E[X(t)]$和$E[X(t+\tau)X(t)]$这两个统计数据发现原点被动过。

与𝑡无关可以使许多数学上的分析变得容易，所以通信的教材中普遍使用了平稳过程这个模型。该模型对诸如噪声在内的不少信号而言也是靠谱的。  

随机过程$X(t)$是沿时间排列的无数随机变量，一般来说它们的数学期望不一定相同，即$E[X(t)]=m_X(t)$一般是绝对时间𝑡的函数。如果$X(t)$的均值、自相关函数都与绝对时间𝑡无关，就叫广义平稳过程  
$$E[X(t)]=m_X(t),E[X(t+\tau)X(t)]=R_X(\tau)$$

**遍历性**  
广义平稳遍历过程（简称遍历过程）是平稳过程的一个特殊情况。均值和自相关满足遍历性的平稳过程叫做广义遍历过程  
设$X(t)$是广义平稳过程，同时满足足均值遍历性和自相关函数遍历性，那么它就是平稳遍历过程。均值遍历性的意思是所有样本函数的时间平均相同，自相关遍历性的意思是所有样本函数按时间平均算出的自相关函数相同。

**功率谱密度**  
随机过程的功率谱密度是样本函数的功率谱密度的统计平均，是平均自相关函数的傅氏变换。  
平稳过程的自相关函数本身就与绝对时间无关，不需要再去求时间平均以消掉t。因此平稳过程的功率谱密度就是自相关函数的傅氏变换：$P_X(f) = \int^\infty _{-\infty} {R_X(\tau)e^{-j2\pi f\tau}d\tau}$  
遍历过程的每个样本函数有相同的自相关函数和功率谱密度，获得某一个样本的功率谱密度就获得了$X(t)$的功率谱密度。  



### 联合平稳过程
设有两个随机过程$X(t),Y(t)$，它们各自是平稳过程，即它们的均值、自相关函数都与绝对时间t无关。如果这两个平稳过程的互相关函数也与绝对时间t无关，即若$E[X(t+\tau)Y(t)]=R_{XY}(\tau)$，则称$X(t),Y(t)$联合平稳  
如果两个随机过程联合平稳，则它们的和一定平稳，如果和不平稳，不能判断其是否联合平稳。  

两个随机过程不相关：对于任意两个时刻$t_1,t_2$有$E[X(t_1)Y(t_2)]=E[X(t_1)]E[Y(t_2)]$  
两个随机过程在同一时刻不相关：对于任意一个相同的时刻$t_0$有$E[X(t_0)Y(t_0)]=E[X(t_0)]E[Y(t_0)]$  
零均值随机变量或随机过程的相关系数：方差归一后的相关值  



### 平稳过程通过线性系统
随机过程$X(t)$通过滤波器，就是随机抽出的每个样函数通过滤波器形成一个新的样本函数，这样便形成了一个新的随机过程$Y(t)$。  
如果输入的随机过程是零均值，即$E[X(t)]=0$，那么输出的随机过程也是零均值，$E[Y(t)]=0$。  
如果输入是平稳过程，输出也是平稳过程。  
平稳过程通过滤波器之后，输入与输出是联合平稳的。  

希尔伯特变换不改变功率谱密度、不改变功率（功率谱密度的积分）、不改变自相关函数（功率谱密度的傅氏反变换）



### 复平稳过程
本课中的解析信号、复包络都是复信号，所以需要把平稳过程的概念推广到复随机过程。 



### 平稳序列和循环平稳
手机发射信号时，先是有一个携带信息的随机序列，然后把这个序列变成了时间连续的波形。在多数情况下，这样形成的波形不是平稳过程，而是循环平稳过程。本讲介绍平稳序列、循环平稳过程的概念  


一般随机过程：随机过程$X(t)$的均值与自相关函数与t有关  
$$E[X(t)]=m_X(t),E[X(t+\tau)X(t)]=R_X(t+\tau,t)$$
广义平稳过程：均值、自相关函数与t无关  
$$E[X(t)]=m_X,E[X(t+\tau)X(t)]=R_X(\tau)$$
循环（周期）平稳过程：均值、自相关函数是t的周期函数。循环平稳过程不是平稳过程  
$$E[X(t+T)]=E[X(t)],E[X(t+T+\tau)X(t+T)]=E[X(t+\tau)X(t)]$$



### 高斯过程
**Gauss**  
约翰·卡尔·弗里德里希·高斯（Johann Carl Friedrich Gauß）
单个随机变量：高斯概率密度函数  
两个随机变量：不相关＝独立，独立高斯的联合概率密度函数  
多个随机变量：联合高斯（任意线性组合还是高斯的联合概率密度函数）  
随机过程：随机过程上的所有随机变量联合高斯。对于线性时不变系统，高斯过程与确定函数卷积后还是高斯过程。对于线性时变系统，高斯过程与确定函数乘积后还是高斯过程。 
高斯随机变量（正态分布）$X\sim N(\mu,\sigma^2)$的概率密度函数为$p_X(x)=\frac{1}{\sqrt{2\pi \sigma^2}}e^{-\frac{(x-a)^2}{2\sigma^2}}$  
$$E[X]=\mu,D[X]=E[(X-\mu)^2]=\sigma^2$$


**联合高斯**  
联合高斯：独立高斯的线性组合。  
高斯过程：随机过程上的随机变量统统联合高斯
高斯过程乘以确定信号还是高斯过程  
高斯过程通过滤波器后还是高斯过程  
零均值高斯平稳随机过程通过线性时不变系统后还是零均值高斯平稳随机过程  



### 加性白高斯噪声
加性白高斯噪声（Additive White Gaussian Noise, AWGN）是通信中最基础、最广泛的噪声模型。  
Additive：噪声与通信信号是叠加关系，噪声与通信信号统计独立。  
Gauss：噪声的随机电压服从高斯分布。  
White：在实际应用中，是指在工作频带范围内噪声的功率谱密度是常数；在数学模型中，是指噪声功率谱密度在整个频率轴上是常数  
按数学模型看，AWGN的二阶矩无穷大。因此，AWGN是按带宽有限的噪声的极限定义的。在实际应用中，则是指带宽充分大，且在工作频带内频谱均匀的高斯噪声。  
加性白高斯噪声是一种零均值平稳高斯随机过程。实际当中，如果某个通信系统遭遇了某种干扰，该干扰的瞬时电压取值呈现出高斯分布特征，并在我们关注的频谱范围内，该干扰的功率谱密度基本是常数，则可以将该干扰建模为AWGN。



### 窄带高斯白噪声
**窄带高斯白噪声的特点**  
> 信道带宽B远小于信道载波频点$f_0$  
> 噪声表现为准正弦震荡  
> 均值为零的窄带平稳高斯过程$n(t) \sim N(0, \sigma_n^2)$  

  

包络分量：Rayleigh分布  
相位分量：均匀分布  

同相分量I：$n_I(t) \sim N(0, \sigma_n^2)$  
正交分量Q：$n_Q(t) \sim N(0, \sigma_n^2)$  
窄带高斯噪声的同相分量和正交分量也是平稳高斯过程，均值为零，方差相同，同一时刻的同相分量I和正交分量Q相互独立，互不相关  


同相分量、正交分量与均为零均值平稳过程，并且与窄带高斯白噪声的功率相同包络分量、相位分量分别服从瑞利、均匀分布叠加了高频载波后，窄带噪声的同相和正交分量仍为高斯过程

**高频载波加窄带高斯噪声**  



## 信道

### 无线信道

### 有线信道

### 调制信道模型

### 编码信道模型

### 信道中的噪声

### 信道容量









## 模拟调制系统
模拟调制系统将一个模拟基带信号$m(t)$（例如话筒产生的声音信号）变成带通信号$s(t)$（通过天线发射的高频信号），以及如何从这个带通信号$s(t)$获得原来所发送的$m(t)$。
现在的通信系统几乎都是数字通信。我们学习模拟调制的目的并不是因为某些模拟调制技术在个别地方还在用，而是因为其中的基本原理、基本思想、基本问题以及相关的数学分析方法——这些内容在数字通信中也是跑不掉的。
本课主要关注两点：一是频谱占用情况，二是受到噪声干扰情况下接收质量，这两点也常被称为有效性和可靠性指标。

模拟信号（analog signal）$m(t)$是t的连续函数，时间连续、取值连续。
数字信号（digital signal）$x[k]$指TTL、ECL等逻辑信号，时间离散、取值离散。


调制（modulation）
解调（demodulation）
调制信号（modulating signal）$m(t)$
已调信号（modulated signal）$s(t)$

无失真信道（distortion less channel）
本章假设传输已调信号$s(t)$的带通信道是理想无失真信道对于接收端恢复信息来说，收到的信号大小与发送端不同不是问题，加一个放大器就好；信号到达接收端的时间稍微晚一点，比如延迟几个微秒毫秒也没关系。但如果到达接收端的波形样子与发送波形不同，就是问题。波形形状不同，就是有失真（distortion）。
无失真：波形的形状不变，可以有延迟，可以幅度不同
$s(t) \to K\cdot s(t-t_0)$

$$m(t) \stackrel{modulation}{\longrightarrow} s(t) \stackrel{Gauss}{\longrightarrow} s(t) + n_w(t) \stackrel{BPF}{\longrightarrow} s(t)+n(t) \stackrel{demodulation}{\longrightarrow} m(t)+n_o(t)$$

因为有信道噪声，所以接收端在解调之前，先用一个带通滤波器（band-pass filter, BPF）来抑制噪声

模拟调制的基本思路：发送端：让$s(t)$的复包络$s_L(t)$携带$m(t)$。接收端：从复包络中获得$m(t)$

**I/Q调制与I/Q解调**
现代通信设备（例如你的手机）中，发送端标配有I/Q调制器（或者叫正交调制器），其输入是一对实信号，分别是$s(t)$的同相分量和正交分量，输出是$s(t)$。也即：I/Q调制器负责把复包络变成带通信号。接收端标配有I/Q解调器，做相反的工作，其输出是接收到的带通信号的同相、正交分量。

**复调制与复解调**
复调制（complex modulator）和复解调（complex demodulator）




模拟调制的典型方法
幅度类
复包络直接就是$m(t)$——DSB-SC
包络（复包络的模）携带$m(t)$——AM
复包络是$m(t)$的解析信号——SSB

相位类
复包络的相位$\varphi(t)$与$m(t)$成正比——PM
$\varphi(t)$的时间变化率$\varphi'(t)$与$m(t)$成正比——FM

**关键性能指标**
发送端：已调信号的带宽及频谱特征。涉及频谱资源的占用情况（效率）
接收端：输出信噪比。涉及抗噪声能力（质量）
输出信噪比定义为输出端有用信号的平均功率比上输出端噪声的平均功率。注意是平均功率的比值，不是功率比值的平均。


### 模拟调制

### DSB-SC

#### 双边带抑制载波调制
DSB调制是一种非常基础的调制方式，也是一种非常重要的调制方式。它不仅仅是一种模拟信号的正弦调制方式，很多数字调制实际上也是DSB调制。


基带信号与高频载波相乘，所形成的信号频谱有两个边带，故称双边带（ DSB，Double Side-Band）。DSB属于幅度类调制。DSB是一种非常基础的调制。一切正弦调制（包括数字调制）本质上都可以直接或间接表示为DSB调制。
SC（Suppressed-Carrier）表示已调信号中没有载频分量（功率谱密度在𝑓𝑓c处没有冲激）
DSB的系统框图如下：

DSB已调信号的表达式为：$s(t) = m(t) \cdot A_c \cos(2\pi f_c t + \phi)$
DSB信号是带通信号的特例，它只有同相分量，没有正交分
量，其复包络是
$m(t)>0$时 ， $s(t)$与载波$\cos(2\pi f_c t + \phi)$同相；$m(t)<0$时，$s(t)$与载波反相。



#### DSB-SC的相干解调

相干解调的抗噪声性能

### AM
包络调制（, AM）属于DSB家族的一种，是DSB-SC基础上的一个小变化。从历史的时间轴看，AM是第一个用来传输模拟基带信号的模拟调制技术。1900年12月23号，加拿大人Reginald Fessenden利用AM实现了人类历史上首次无线电通话。
直观来说，AM是让正弦波的振幅随基带信号摆动。这个摆动的幅度最大不超过正弦波自身的振幅。调幅系数或调制指数反映这一点。
AM相当于DSB-SC叠加载波。叠加的载波越大，总功率中携带信息的DSB-SC部分的占比就越小，这个占比叫做AM的调制效率。


AM包络检波的抗噪声性能



### SSB

双边带信号的频谱特征是载频左右有对称的两个边带，时域特征是只有同相分量没有正交分量的信号：
从数学上来说，DSB的两个边带中如果已知其中一个，可以求出另外一个。这意味着，信号传输时没有必要把两个边带都传过去。去掉DSB的两个边带中的一个后传输，这就是单边带的想法。
实现SSB的方法例如可以用滤波器：将DSB信号通过一个适当的滤波器去除两个边带中的一个。
单边带调制（Single SideBand, SSB）

DSB的两个边带中，频率比𝑓𝑓c低的那个叫下边带（Lower SideBand），比载频高的叫上边带（Upper SideBand）。去除下边带，保留上边带就是上单边带调制（USB）。去除上边带，保留下边带就是下单边带调制（LSB）



### 角度调制


#### FM的抗噪声性能


### FDM
Multiplexing（多路复用）是一种技术，其目的是为了让多路信号共享一个传输媒质（如电缆、光纤、卫星转发器、无线空间等）。频分复用FDM是复用技术的一种。它把频带作为资源，给不同的信号分配不同的频域区间。每路信号借助模拟调制（通常是SSB或DSB）把自己搬到分配给自己的频带位置上。在光通信中，FDM这个概念叫WDM（波分复用）。

FDM是最早提出的复用技术。后来老师说，FDM落后了，先进的是TDM。再后来老师说，TDM落后了，先进的是CDM。再后来老师说，CDM落后了，先进的是OFDM。

复用（multiplexing）的意思是将多个信息信号合在一起，变成一个信号后传输
${m_1(t), m_2(t), ... , m_n(t)} \stackrel{Multiplexing}{\longrightarrow} s(t) \stackrel{De-Multiplexing}{\longrightarrow} {m_1(t), m_2(t), ... , m_n(t)}$$$

频分复用(FDM)：频域正交：
时分复用(TDM)
码分复用(CDM)
数学原理在于这些叠加的信号彼此正交。

典型的复用方法包括：FDM、TDM、CDM等
FDM是把多个基带信号用不同的载频进行模拟调制后合为一路。合成信号中各路的频谱不交叠。
FDM信号总体上可以当作是一个基带信号，通过带通信号传输时还需要采用某种调制。




## 数字调制

### QPSK
QPSK 是数字调制中用的最普遍的。天上的卫星，地上的手机，都在用 QPSK。
QPSK 与其他数字调制的亲缘关系见下图。
四相移相键控（Quadrature Phase Shift Keying, QPSK），也叫4PSK，表明正弦载波有四个可能的相位。是I/Q正交（quadrature）的两个PSK。
4PSK是一种四进制信号，它在$[0, T_s]$时间内发送以下四种信号之一：
理论上，只要$\theta_1, \theta_2, \theta_3, \theta_4$是四种不同的相位都可以叫4PSK。  
实际设计中一般将$\theta_1, \theta_2, \theta_3, \theta_4$设计为间隔$\frac{\pi}{2}$的均匀相位。  

### OQPSK
“抠门”是通信技术发展的原动力。因为舍不得花钱买频谱，所以就得精打细算：  
（1）凡是遇到用 BPSK 的地方，一律再叠一个正交的 BPSK。一个频带传两个 BPSK。  
（2）用滚降。矩形脉冲成形的 QPSK 按主瓣算的频谱效率是 1bit/s/Hz。升余弦滚降 QPSK 的频带利用率是$\frac{2}{1+\alpha}$，如果滚降系数是 0.25，就是 1.6bit/s/Hz。同样的频带，多传了60%。看着用户手机上网的网速提高了60%，我们真的很高兴，因为单位时间收到的流量费也跟着提升了 60%。  

舍不得花钱买装备，比如放大器，也得精打细算：
线性的功放技术指标很好，但是价格也高，而且还耗电。在卫星上装这个放大器，卫星燃料耗的快、寿命就得缩短，发一颗卫星要花很多钱的。非线性功放造价低而且省电，可就是对包络起伏敏感。怎么办呢？我想啊想，想啊想，终于让我想出办法了：把 QPSK 的 I、Q 两路时间错开！老板给我戴上了大红花，他的脸也笑成了花——公司的成本大幅度降低，但对用户的收费标准不用变。

偏移四相移相键控（OQPSK）


## 数字基带传输系统
数数字通信系统平均每1秒钟时间内发送的比特个数称为据速率（data rate）、比特速率（bit rate）或信息速率（information rate）
记为$R_b$，单位是$bit/s$
比特间隔$T_b = \frac{1}{R_b}$


频带利用率或频谱效率（spectral efficiency）。

数字通信系统所发送的比特或符号在接收端可能出错，按比特算的错误率称为误比特率$P_b$，按符号算的错误率称为误符号率$P_s$。



### 眼图
眼图是工程中使用的一种观测手段，通过观察眼图可以了解数字基带系统的许多信息。眼图是对数字基带信号的实验观察。

具体做法：用示波器观察接收滤波器的输出信号，然后调整示波器的水平扫描周期，使其与接收符号周期同步。这时就可以从示波器显示的图形上，观察出ISI和噪声的影响，从而进行性能评估。在传输二进制信号波形时，示波器显示的图形很像人的眼睛，故称之为眼图。

眼图张开的大小反映ISI的强弱
最佳抽样时刻：“眼睛”张开最大的时刻
对定时误差的灵敏度：斜边之斜率
信号幅度畸变范围：阴影区的垂直高度
过零点畸变：阴影区的水平宽度
判决门限电平：中央横轴
噪声容限：抽样时刻眼睛张开高度之半


## 数字带通传输系统


## 数字频带传输系统

## 数字信号最佳接收

### 信号空间
空间（Space）是三维空间$R^3$中的点的集合。
线性空间（linear space）：空间中的向量对线性运算满足封闭性，即空间内几个点的线性运算生成的新的点依然在空间内。  
线性内积空间：线性空间定义有内积，  

归一化正交基

信号空间（signal space）：一种线性内积向量空间，它是波形（实能量信号）的集合：$\Omega={x_1(t),x_2(t),...}$  
信号空间中的波形对线性运算满足封闭性
两个实信号的内积是
与平方范数、平方长度对应的概念是能量
两个信号的平方欧氏距离是差的能量

## 信源编码







## 正交编码与伪随机序列








## 差错控制编码











## 同步原理


## MASK
M进制振幅键控（MASK）：MASK是MPAM基带信号对载波做DSB调制  
在一条直线上摆M个点，就是MASK。这条直线就是是基函数，不同的星座点是不同幅度的正弦波。M=2的情形是2ASK。按点的摆法，可以摆成OOK、可以摆成BPSK。


## M进制数字调制系统比较

**不同维数的数字调制**
一维调制：OOK、BPSK、MASK
二维调制（I/Q调制）：MPSK、MQAM
二维调制（频率正交）：2FSK
多维调制（频率正交）：MFSK

**相干调制和非相干调制**
只能相干解调：BPSK、QPSK、OQPSK、MASK、MPSK、MQAM
支持非相干解调：OOK、2FSK、2DPSK、DQPSK、MFSK



# 北京交通大学 891 通信原理

1. 通信系统概述  
（1）信息与通信基本概念  
（2）通信系统模型  
（3）通信系统性能指标  
（4）通信信道分类及特征  
2. 信号与噪声分析  
（1）随机过程的统计特性与数字特征分析  
（2）平稳随机过程及传输特性分析  
（3）高斯白噪声及窄带高斯白噪声分析  
3. 模拟调制系统  
（1）调制的基本概念  
（2）幅度调制信号的调制解调原理与性能分析  
（3）角度调制信号的调制解调原理与性能分析  
（4）频分复用系统的原理与分析  
4. 模拟信号数字化  
（1）基带信号抽样与频带信号抽样  
（2）量化器设计原理与量化噪声分析  
（3）线性 PCM、对数压扩 PCM 编解码方法  
（4）时分复用系统原理与分析  
（5）增量调制原理与量化噪声分析  
5. 数字信号基带传输  
（1）数字基带信号的时域及频域特征  
（2）奈奎斯特第一准则与数字基带传输系统性能分析  
（3）部分响应系统的原理与实现  
（4）眼图与信道时域均衡原理  
6. 数字信号频带传输  
(1) 二元数字调制系统实现原理与性能分析  
(2) 四元相移键控调制（QPSK 及其派生方式）实现原理与性能分析  
(3) MASK、MFSK 调制与 QAM 调制实现原理与性能分析  
7. 数字信号最佳接收  
(1) 信号空间分析法与最佳接收准则  
(2) 二元最佳接收机的实现形式与误码率分析  
(3) 最佳数字基带传输系统  
8. 差错控制编码  
(1) 差错控制编码基本概念与纠错检错能力分析  
(2) 线性分组码与循环码的概念、编译码算法  
(3) 卷积码的概念、表示方法与编译码算法  

参考书目：郭宇春等，《通信系统原理》，科学出版社。ISBN 978-7-03-033528-9




